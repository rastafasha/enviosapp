<app-loading *ngIf="isLoading"></app-loading>

<!-- Page Content-->
<div class="container" *ngIf="!isLoading">
    <div class="back-title">

        <a routerLink="/myprofile">
            <button class="boton_azul_borde">Volver</button>
        </a>
    </div>

    <div class="num_tracking">
        <!-- Content  -->
        <section class="col-lg-12">

            <!-- Secci贸n del Mapa -->
            <div class="map-section">
                <h4><i class="fa fa-map-marker"></i> Seleccionar Ubicaci贸n</h4>
                <p class="text-muted">Haz clic en el mapa para seleccionar la ubicaci贸n de tu direcci贸n</p>
                
                <!-- Contenedor del mapa -->
                <div #mapContainer class="map-container"></div>
                
                <!-- Loading del mapa -->
                <div class="map-loading" *ngIf="mapLoading">
                    <div class="spinner"></div>
                    <p>Obteniendo ubicaci贸n...</p>
                </div>
                
                <!-- Error del mapa -->
                <div class="map-error" *ngIf="mapError">
                    <p>锔 {{ mapError }}</p>
                </div>
                
                <!-- Bot贸n ubicaci贸n actual -->
                <button class="btn btn-primary btn-block location-btn" (click)="useCurrentLocation()">
                    <i class="fa fa-crosshairs"></i> Usar mi ubicaci贸n actual
                </button>
                
                <!-- Coordenadas seleccionadas -->
                <div class="coords-display" *ngIf="selectedCoords">
                    <span class="label"> Ubicaci贸n seleccionada:</span>
                    <span class="value">{{ selectedCoords.lat.toFixed(6) }}, {{ selectedCoords.lng.toFixed(6) }}</span>
                </div>
            </div>

            <!-- Profile form-->
            <form class=" p-t-20 col-xs-12" [formGroup]="direccionForm" (ngSubmit)="onSubmit()">
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Nombre y apellidos</label>
                        <input class="form-control" type="text" required placeholder="Nombres y apellidos"
                            formControlName="nombres_completos">

                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Pa铆s</label>
                        <div class="input-group form-label labelgoogle">
                            <select class="form-control" formControlName="pais">
                                <option [value]=" ">Seleccione Pa铆s</option>
                                <option *ngFor="let data of paises" [value]="data.pais">
                                    {{data.pais}}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label>Direcci贸n</label>
                        <textarea class="form-control" placeholder="Ingrese la direcci贸n" required
                            formControlName="direccion"></textarea>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="form-group">
                        <label>Referencia (Coordenadas)</label>
                        <textarea class="form-control" placeholder="Seleccione la ubicaci贸n en el mapa" required
                            formControlName="referencia"></textarea>
                        <small class="text-muted">
                            <i class="fa fa-info-circle"></i> 
                            Seleccione la ubicaci贸n haciendo clic en el mapa. Las coordenadas se guardar谩n autom谩ticamente.
                        </small>
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="form-group">
                        <label>Ciudad</label>
                        <input class="form-control" type="text" id="address-fn" required placeholder="Ciudad"
                            formControlName="ciudad">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label>ZIP</label>
                        <input class="form-control" type="text" id="address-fn" required placeholder="C贸digo Postal"
                            formControlName="zip">
                    </div>
                </div>

                <button type="submit" [disabled]="direccionForm.invalid"
                    class="btn btn-success waves-effect waves-light m-r-10 btn-block">
                    <i class="fa fa-save"></i> Guardar cambios
                </button>
            </form>

        </section>
    </div>
</div>

